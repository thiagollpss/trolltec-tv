<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>üé¨ Cat√°logo de Filmes</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #111;
      color: #fff;
    }

    header {
      background-color: #222;
      padding: 20px;
      text-align: center;
      font-size: 26px;
    }

    .filtros {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      padding: 10px 20px;
      background-color: #1a1a1a;
    }

    select, input {
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: none;
    }

    .catalogo {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 20px;
      padding: 20px;
    }

    .filme {
      background-color: #1e1e1e;
      border-radius: 10px;
      overflow: hidden;
      transition: transform 0.3s;
    }

    .filme:hover {
      transform: scale(1.05);
    }

    .filme img {
      width: 100%;
      display: block;
    }

    .info {
      padding: 10px;
    }

    .titulo {
      font-size: 16px;
      margin-bottom: 5px;
    }

    .nota {
      font-size: 14px;
      color: #fbc02d;
    }

    .sinopse {
      font-size: 12px;
      color: #ccc;
      margin-top: 5px;
    }

    .botao {
      text-align: center;
      margin: 20px;
    }

    button {
      padding: 10px 20px;
      background-color: #4fc3f7;
      color: #111;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }

    button:hover {
      background-color: #03a9f4;
    }

    footer {
      text-align: center;
      padding: 15px;
      font-size: 13px;
      color: #888;
      background-color: #222;
    }

    a {
      color: #4fc3f7;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <header>üé¨ Cat√°logo de Filmes Atualizado</header>

  <div class="filtros">
    <select id="genero" onchange="filtrarFilmes()">
      <option value="">Todos os G√™neros</option>
    </select>
    <input type="text" id="busca" placeholder="Buscar por nome..." oninput="buscarFilmes()">
  </div>

  <section class="catalogo" id="catalogo">
    <p style="grid-column: 1 / -1;">Carregando filmes...</p>
  </section>

  <div class="botao">
    <button onclick="carregarMais()">Carregar mais filmes</button>
  </div>

  <footer>
    Dados fornecidos por <a href="https://www.themoviedb.org/" target="_blank">TMDb</a>
  </footer>

  <script>
    const API_KEY = "0dc3ebb978206e9879e851cb9bb3d026";
    let pagina = 1;
    let generoAtual = "";
    let buscaAtual = "";
    let carregando = false;

    const catalogo = document.getElementById("catalogo");
    const generoSelect = document.getElementById("genero");

    async function carregarGeneros() {
      const url = `https://api.themoviedb.org/3/genre/movie/list?api_key=${API_KEY}&language=pt-BR`;
      const resp = await fetch(url);
      const dados = await resp.json();

      dados.genres.forEach(genero => {
        const option = document.createElement("option");
        option.value = genero.id;
        option.textContent = genero.name;
        generoSelect.appendChild(option);
      });
    }

    async function carregarFilmes(reset = false) {
      if (carregando) return;
      carregando = true;

      if (reset) {
        catalogo.innerHTML = "";
        pagina = 1;
      }

      let url;

      if (buscaAtual) {
        url = `https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&language=pt-BR&query=${encodeURIComponent(buscaAtual)}&page=${pagina}`;
      } else {
        url = `https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&language=pt-BR&sort_by=popularity.desc&page=${pagina}`;
        if (generoAtual) {
          url += `&with_genres=${generoAtual}`;
        }
      }

      try {
        const resp = await fetch(url);
        const dados = await resp.json();

        if (dados.results.length === 0 && pagina === 1) {
          catalogo.innerHTML = "<p>Nenhum filme encontrado.</p>";
        }

        dados.results.forEach(filme => {
          if (!filme.poster_path) return;

          const div = document.createElement("div");
          div.classList.add("filme");

          div.innerHTML = `
            <img src="https://image.tmdb.org/t/p/w300${filme.poster_path}" alt="${filme.title}">
            <div class="info">
              <div class="titulo">${filme.title}</div>
              <div class="nota">‚≠ê ${filme.vote_average.toFixed(1)}</div>
              <div class="sinopse">${filme.overview ? filme.overview.substring(0, 100) + '...' : 'Sem sinopse.'}</div>
            </div>
          `;

          catalogo.appendChild(div);
        });

        pagina++;
      } catch (erro) {
        console.error("Erro ao carregar filmes:", erro);
        catalogo.innerHTML = "<p>Erro ao carregar filmes.</p>";
      }

      carregando = false;
    }

    function carregarMais() {
      carregarFilmes();
    }

    function filtrarFilmes() {
      generoAtual = generoSelect.value;
      buscaAtual = "";
      document.getElementById("busca").value = "";
      carregarFilmes(true);
    }

    function buscarFilmes() {
      buscaAtual = document.getElementById("busca").value;
      generoAtual = "";
      generoSelect.value = "";
      carregarFilmes(true);
    }

    // Inicializa√ß√£o
    carregarGeneros();
    carregarFilmes();
  </script>
</body>
</html>
